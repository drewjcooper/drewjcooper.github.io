{% capture tocWorkspace %}
  {% comment %}
    Usage:
        {% include series_toc.html html=content sanitize=true class="inline_toc" id="series_toc" h_min=2 h_max=3 %}
    Parameters:
        * html       (string) - the HTML of compiled markdown generated by kramdown in Jekyll
    Optional Parameters:
        * sanitize   (bool)   : false  - when set to true, the headers will be stripped of any HTML in the TOC
        * class      (string) :   ''   - a CSS class assigned to the TOC
        * id         (string) :   ''   - an ID to assigned to the TOC
        * h_min      (int)    :   1    - the minimum TOC header level to use; any header lower than this value will be ignored
        * h_max      (int)    :   6    - the maximum TOC header level to use; any header greater than this value will be ignored
        * ordered    (bool)   : false  - when set to true, an ordered list will be outputted instead of an unordered list
        * item_class (string) :   ''   - add custom class for each list item; has support for '%level%' placeholder, which is the current heading level
        * baseurl    (string) :   ''   - add a base url to the TOC links for when your TOC is on another page than the actual content
    Output:
        An ordered or unordered list representing the table of contents of a markdown block. This snippet will only generate the table of contents and will NOT output the markdown given to it
  {% endcomment %}
  {% capture series_toc %}{% endcapture %}
  {% assign seriesTitle = include.series_title | default: "" %}
  
  {% if include.class %}
    {% capture series_toc %}{:.{{ include.class }}}{% endcapture %}
  {% endif %}

  {% assign series_posts = site.posts | where: "series", seriesTitle | reverse %}
  
  {% for post in series_posts %}
    {% capture series_toc %}{{ series_toc }}
- {% if post.title == page.title %}<span>{{ post.title }}</span>{% else %}[{{ post.title }}]({{ post.url }}){% endif %}{% endcapture %}
  {% endfor %}
{% endcapture %}{% assign tocWorkspace = '' %}{{ series_toc | markdownify | strip }}